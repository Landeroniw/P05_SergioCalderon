
<html>
<head>
        <link href="main.css" rel="stylesheet"/>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  
    <title>Pr√°ctica 5: Series de Fourier en tiempo continuo</title>
    <meta name="generator" content="MATLAB 9.6">
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
    <meta name="DC.date" content="2019-04-15"><meta name="DC.source" content="fun1.m">
</head>
    
<body>
     <h1 id ="gg">UPIITA</h1>  
        <h1 id ="gg">IPN</h1>
        <h1 id ="gg">Integrantes:</h1> 
        <p>        Bravo Padilla Eric</p>
        <p>        Calderon Landeros Sergio David</p>
        <p>        Sanchez Lara Jose Maria</p>
        <p>        Noe Millan Yuval Zuriel</p>
        <p></p>
    
    <img src="01.PNG" class="responsive2">
    <img src="02.PNG" class="responsive2">
    <img src="03.PNG" class="responsive2">
    <img src="03.PNG" class="responsive2">
<h1 id ="gg">Ejemplo 6.1</h1> 
    <div class="content"><pre class="codeinput">d0=0.5043;
a=-7;
b=7;
t0=0;
tf=pi;
f=@(t) ((t&gt;0)&amp;(t&lt;=pi)).*exp(-t/2);
cn=@(n) 0.5043*(2/((1+16*n^2)^(1/2)));
tn=@(n) -atan(4*n);
armo=4;
so=@(t) f(t)+f(t+pi)+f(t+2*pi)+f(t+3*pi)+f(t-pi)+f(t-2*pi)+f(t-3*pi);
sfc(t0,tf,cn,d0,so,armo,a,b,tn)
</pre><pre class="codeoutput">C0 = 0.5043
C1 = 0.24462
C2 = 0.1251
C3 = 0.08376
C4 = 0.062915
</pre><img vspace="5" hspace="5" src="Prueba_01.png" alt="">
        <div class="content"><pre class="codeinput">d0=0.5043;
a=-21;
b=24;
t0=0;
tf=pi;
f=@(t) ((t&gt;0)&amp;(t&lt;=pi)).*exp(-t/2);
cn=@(n) 0.5043*(2/((1+16*n^2)^(1/2)));
tn=@(n) -atan(4*n);
armo=15;
so=@(t) f(t)+f(t+pi)+f(t+2*pi)+f(t+3*pi)+f(t-pi)+f(t-2*pi)+f(t-3*pi)+f(t+4*pi)+f(t-4*pi)+f(t+5*pi)+f(t-5*pi)+f(t-6*pi)+f(t+6*pi)+f(t+7*pi)+f(t-7*pi);
sfc(t0,tf,cn,d0,so,armo,a,b,tn)
</pre><pre class="codeoutput">C0 = 0.5043
C1 = 0.24462
C2 = 0.1251
C3 = 0.08376
C4 = 0.062915
C5 = 0.050367
C6 = 0.041989
C7 = 0.035998
C8 = 0.031503
C9 = 0.028006
C10 = 0.025207
C11 = 0.022917
C12 = 0.021008
C13 = 0.019393
C14 = 0.018008
C15 = 0.016808
</pre><img vspace="5" hspace="5" src="Prueba11_01.png" alt=""> 
            <h1 id ="gg">Ejemplo 6.2</h1> 
            <div class="content"><pre class="codeinput">t0=-0.5;
tf=1.5;
armo=4;
a=-7;
b=7;
c0=0;
f=@(t) ((t&gt;-0.5)&amp;(t&lt;=0.5)).*(6*t) + ((0.5&lt;t)&amp;(1.5&gt;=t)).*(6*(1-t));
cn=@(n) (8*3)/((pi*n)^2);

sfcc(t0,tf,cn,c0,f,armo,a,b)
</pre><pre class="codeoutput">D(-4) = 0
D(-3) = 8.2722e-18+0.13509i
D(-2) = 0
D(-1) = 7.445e-17-1.2159i
D(0) = 0
D(1) = 7.445e-17-1.2159i
D(2) = 0
D(3) = 8.2722e-18+0.13509i
D(4) = 0
</pre><img vspace="5" hspace="5" src="Segundoejemplo_01.png" alt=""> <p class="footer"><br>
                
<div class="content"><pre class="codeinput">t0=-0.5;
tf=1.5;
armo=15;
a=-7;
b=7;
c0=0;
f=@(t) ((t&gt;-0.5)&amp;(t&lt;=0.5)).*(6*t) + ((0.5&lt;t)&amp;(1.5&gt;=t)).*(6*(1-t));
cn=@(n) (8*3)/((pi*n)^2);

sfcc(t0,tf,cn,c0,f,armo,a,b)
</pre><pre class="codeoutput">D(-15) = 3.3089e-19+0.0054038i
D(-14) = 0
D(-13) = 4.4053e-19-0.0071944i
D(-12) = 0
D(-11) = 6.1529e-19+0.010048i
D(-10) = 0
D(-9) = 9.1913e-19-0.015011i
D(-8) = 0
D(-7) = 1.5194e-18+0.024813i
D(-6) = 0
D(-5) = 2.978e-18-0.048634i
D(-4) = 0
D(-3) = 8.2722e-18+0.13509i
D(-2) = 0
D(-1) = 7.445e-17-1.2159i
D(0) = 0
D(1) = 7.445e-17-1.2159i
D(2) = 0
D(3) = 8.2722e-18+0.13509i
D(4) = 0
D(5) = 2.978e-18-0.048634i
D(6) = 0
D(7) = 1.5194e-18+0.024813i
D(8) = 0
D(9) = 9.1913e-19-0.015011i
D(10) = 0
D(11) = 6.1529e-19+0.010048i
D(12) = 0
D(13) = 4.4053e-19-0.0071944i
D(14) = 0
D(15) = 3.3089e-19+0.0054038i
</pre><img vspace="5" hspace="5" src="Segundoejemplo11_01.png" alt="">
    
     <h1 id ="gg">Ejemplo 6.4</h1> 
    
    
<div class="content"><pre class="codeinput">cn=@(n) 2/(pi*n);
f=@(t) ((t&lt;=(pi/2))&amp;(t&gt;(-pi/2))).*1 + (((pi/2)&lt;t)&amp;(t&lt;=(3*pi)/2)).*0;
t0=-pi;
tf=pi;
c0=1/2;
armo=4;
a=-7;
b=7;
tn=-pi;

sfccc(t0,tf,cn,c0,f,armo,a,b,tn)
</pre><pre class="codeoutput">D(-4) = 0
D(-3) = 0.1061-1.2994e-17i
D(-2) = 0
D(-1) = -0.31831
D(0) = 0.5
D(1) = 0.31831
D(2) = 0
D(3) = -0.1061-1.2994e-17i
D(4) = 0
</pre><img vspace="5" hspace="5" src="Tercerejemplo_01.png" alt="">
    
    
<div class="content"><pre class="codeinput">cn=@(n) 2/(pi*n);
f=@(t) ((t&lt;=(pi/2))&amp;(t&gt;(-pi/2))).*1 + (((pi/2)&lt;t)&amp;(t&lt;=(3*pi)/2)).*0;
t0=-pi;
tf=pi;
c0=1/2;
armo=15;
a=-7;
b=7;
tn=-pi;

sfccc(t0,tf,cn,c0,f,armo,a,b,tn)
</pre><pre class="codeoutput">D(-15) = 0.021221-2.5988e-18i
D(-14) = 0
D(-13) = -0.024485
D(-12) = 0
D(-11) = 0.028937-3.5438e-18i
D(-10) = 0
D(-9) = -0.035368
D(-8) = 0
D(-7) = 0.045473-5.5688e-18i
D(-6) = 0
D(-5) = -0.063662
D(-4) = 0
D(-3) = 0.1061-1.2994e-17i
D(-2) = 0
D(-1) = -0.31831
D(0) = 0.5
D(1) = 0.31831
D(2) = 0
D(3) = -0.1061-1.2994e-17i
D(4) = 0
D(5) = 0.063662
D(6) = 0
D(7) = -0.045473-5.5688e-18i
D(8) = 0
D(9) = 0.035368
D(10) = 0
D(11) = -0.028937-3.5438e-18i
D(12) = 0
D(13) = 0.024485
D(14) = 0
D(15) = -0.021221-2.5988e-18i
</pre><img vspace="5" hspace="5" src="Tercerejemplo11_01.png" alt="">
    <h1 id ="gg">Ejemplo 6.5</h1> 
    <!-- -->
    <div class="content"><pre class="codeinput">d0=0.5043;
a=-7;
b=7;
t0=0;
tf=pi;
f=@(t) ((t&gt;0)&amp;(t&lt;=pi)).*exp(-t/2);
cn=@(n) 0.5043*(2/((1+16*n^2)^(1/2)));
tn=@(n) -atan(4*n);
armo=4;
so=@(t) f(t)+f(t+pi)+f(t+2*pi)+f(t+3*pi)+f(t-pi)+f(t-2*pi)+f(t-3*pi);
sfc2(t0,tf,cn,d0,so,armo,a,b,tn)
</pre><pre class="codeoutput">D(-4) = 0.0019623+0.031396i
D(-3) = 0.0034779+0.041735i
D(-2) = 0.0077585+0.062068i
D(-1) = 0.029665+0.11866i
D(0) = 0.5043
D(1) = 0.029665-0.11866i
D(2) = 0.0077585-0.062068i
D(3) = 0.0034779-0.041735i
D(4) = 0.0019623-0.031396i
</pre><img vspace="5" hspace="5" src="Cuartoejemplo_01.png" alt="">
        <div class="content"><pre class="codeinput">d0=0.5043;
a=-7;
b=7;
t0=0;
tf=pi;
f=@(t) ((t&gt;0)&amp;(t&lt;=pi)).*exp(-t/2);
cn=@(n) 0.5043*(2/((1+16*n^2)^(1/2)));
tn=@(n) -atan(4*n);
armo=15;
so=@(t) f(t)+f(t+pi)+f(t+2*pi)+f(t+3*pi)+f(t-pi)+f(t-2*pi)+f(t-3*pi);
sfc2(t0,tf,cn,d0,so,armo,a,b,tn)
</pre><pre class="codeoutput">D(-15) = 0.00014004+0.0084027i
D(-14) = 0.00016076+0.0090025i
D(-13) = 0.00018643+0.0096945i
D(-12) = 0.00021879+0.010502i
D(-11) = 0.00026035+0.011455i
D(-10) = 0.00031499+0.0126i
D(-9) = 0.00038882+0.013998i
D(-8) = 0.000492+0.015744i
D(-7) = 0.00064242+0.017988i
D(-6) = 0.000874+0.020976i
D(-5) = 0.0012576+0.025152i
D(-4) = 0.0019623+0.031396i
D(-3) = 0.0034779+0.041735i
D(-2) = 0.0077585+0.062068i
D(-1) = 0.029665+0.11866i
D(0) = 0.5043
D(1) = 0.029665-0.11866i
D(2) = 0.0077585-0.062068i
D(3) = 0.0034779-0.041735i
D(4) = 0.0019623-0.031396i
D(5) = 0.0012576-0.025152i
D(6) = 0.000874-0.020976i
D(7) = 0.00064242-0.017988i
D(8) = 0.000492-0.015744i
D(9) = 0.00038882-0.013998i
D(10) = 0.00031499-0.0126i
D(11) = 0.00026035-0.011455i
D(12) = 0.00021879-0.010502i
D(13) = 0.00018643-0.0096945i
D(14) = 0.00016076-0.0090025i
D(15) = 0.00014004-0.0084027i
</pre><img vspace="5" hspace="5" src="Cuartoejemplo11_01.png" alt="">
            
<!---->
  <h1 id ="gg">Ejemplo 6.7</h1>   
<div class="content"><pre class="codeinput">T=3;
dn=1/T;
armo=4;
a=-7;
b=7;

sfc3(dn,armo,a,b,T)
</pre><pre class="codeoutput">D(-4) = 0.33333
D(-3) = 0.33333
D(-2) = 0.33333
D(-1) = 0.33333
D(0) = 0.33333
D(1) = 0.33333
D(2) = 0.33333
D(3) = 0.33333
D(4) = 0.33333
</pre><img vspace="5" hspace="5" src="Quintoejemplo_01.png" alt="">

<div class="content"><pre class="codeinput">T=3;
dn=1/T;
armo=15;
a=-7;
b=7;

sfc3(dn,armo,a,b,T)
</pre><pre class="codeoutput">D(-15) = 0.33333
D(-14) = 0.33333
D(-13) = 0.33333
D(-12) = 0.33333
D(-11) = 0.33333
D(-10) = 0.33333
D(-9) = 0.33333
D(-8) = 0.33333
D(-7) = 0.33333
D(-6) = 0.33333
D(-5) = 0.33333
D(-4) = 0.33333
D(-3) = 0.33333
D(-2) = 0.33333
D(-1) = 0.33333
D(0) = 0.33333
D(1) = 0.33333
D(2) = 0.33333
D(3) = 0.33333
D(4) = 0.33333
D(5) = 0.33333
D(6) = 0.33333
D(7) = 0.33333
D(8) = 0.33333
D(9) = 0.33333
D(10) = 0.33333
D(11) = 0.33333
D(12) = 0.33333
D(13) = 0.33333
D(14) = 0.33333
D(15) = 0.33333
</pre><img vspace="5" hspace="5" src="Quintoejemplo11_01.png" alt=""> 
    <h1 id = "gg">Ejercicio</h1>
    <div class="content"><pre class="codeinput">x= @(t) exp(-t/2);
t = linspace (-10, 10,20001);
sumterms = zeros(16, length(t));
sumterms(1,:) = 0.504;


<span class="keyword">for</span> n = 1:size(sumterms,1)-1
sumterms(n+1,:) = 0.504/(1+4*n*1j).*exp(2*n*t*j);
<span class="keyword">end</span>

x_N = cumsum (sumterms);
figure(1);
clf;
ind = 0;

<span class="keyword">for</span> N = [0,1:2:size(sumterms, 1)-1]
    ind = ind+1;
    subplot (3,3,ind);

    plot (t,x_N(N+1,:),t,x(mod(t,pi)));
    axis ([-10 10 -0.2 1.2]);
    xlabel (<span class="string">'t'</span>);
    ylabel ([<span class="string">'x_{'</span>, num2str(N) ,<span class="string">'} (t)'</span>]);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="penultimo_01.png" alt="">
    
    <div class="content"><pre class="codeinput"><span class="comment">%FUNCION PARA ALGORITMO DEL TRAPECIO COMPUESTO</span>

<span class="keyword">function</span> [int,error]= alg_trapecio(f,a,b,e)
<span class="comment">%Siendo:</span>
<span class="comment">%f= funcion a interar por algoritmo del trapecio compuesto</span>
<span class="comment">%a= limite inferior de la integra</span>
<span class="comment">%b= limite superior de la integra</span>
<span class="comment">%e= numero que ajusta el error</span>

n=15;<span class="comment">%valor solicitado por el ejercicio</span>


h=(b-a)/n;
ff=sym(f);
dd=diff(diff(ff));
ddf=matlabFunction(dd);
int=(h/2)*(f(a)+f(b));
error=-(((b-a)/12)*h^2)*ddf(e);
suma=0;

<span class="keyword">for</span> i=1:1:(n-1)
    x0=a+i*h;
    suma=suma+f(x0);
<span class="keyword">end</span>
int=int+h*suma;

<span class="keyword">end</span>
</pre>
       
        
        <div class="content"><pre class="codeinput"><span class="comment">%Con Algoritmo de trapecio compuesto</span>
</pre><pre class="codeinput">n=[0:1:4];
Dn=[alg_trapecio(x_0,0,pi,pi/2)/T_0,alg_trapecio(x_1,0,pi,pi/2)/T_0,alg_trapecio(x_2,0,pi,pi/2)/T_0,alg_trapecio(x_3,0,pi,pi/2)/T_0,alg_trapecio(x_4,0,pi,pi/2)/T_0];

disp(<span class="string">'Funcion: e^(-t/2)'</span>);
disp(<span class="string">'De a: 0   hacia b: 3.1416'</span>);


Magnitud=abs(Dn)
Angulo=angle(Dn)



clf;
subplot (2, 2, 1);
stem(n, abs( (Dn)),<span class="string">'k'</span>);
axis ([-M M -.1 .6]);
xlabel(<span class="string">'n'</span>);
ylabel(<span class="string">'|D_n|'</span>);
subplot (2, 2, 2);
stem(n, angle((Dn)),<span class="string">'k'</span>);
axis([-M M -pi pi]);
xlabel (<span class="string">'n'</span>);
ylabel(<span class="string">'\angle D n [rad]'</span>);
hold <span class="string">on</span>
</pre>
            <pre class="codeinput"><span class="comment">%Con Programa de Lathi volvemos a obtener Dn</span>
</pre><pre class="codeinput">T_0 = pi;
N_0 = 256;
T = T_0/N_0;
t = (0:T:T*(N_0-1))';
M = 10;
x = exp(-t/2);
x(1) = (exp(-pi/2) + 1)/2;

figure(1)

D_n = fft (x)/N_0;
n = [-N_0/2:N_0/2-1]';

<span class="keyword">for</span> a = 1:1:5
mag(a)=abs(fftshift(D_n(a)));
<span class="keyword">end</span>
<span class="keyword">for</span> a = 1:1:5
ang(a)=angle(fftshift(D_n(a)));
<span class="keyword">end</span>
mag
ang



clf;
subplot (2, 2, 1);
stem(n, abs(fftshift (D_n)),<span class="string">'k'</span>);
axis ([-M M -.1 .6]);
xlabel(<span class="string">'n'</span>); ylabel(<span class="string">'|D_n|'</span>);
subplot (2, 2, 2);
stem(n, angle(fftshift(D_n)),<span class="string">'k'</span>);
axis([-M M -pi pi]);
xlabel (<span class="string">'n'</span>);
ylabel(<span class="string">'\angle D n [rad]'</span>);

n = [0:M];
C_n(1) = abs(D_n(1));
C_n(2:M+1) = 2*abs (D_n(2:M+1));
theta_n(1) = angle(D_n(1));
theta_n(2:M+1) = angle(D_n(2:M+1));
subplot (2, 2, 3); stem(n,C_n,<span class="string">'k'</span>);

xlabel (<span class="string">'n'</span>); ylabel(<span class="string">'C_n'</span>);
subplot (2, 2, 4);
stem(n,theta_n,<span class="string">'k'</span>);
xlabel (<span class="string">'n'</span>); ylabel(<span class="string">'\theta n [rad]'</span>);
</pre><p>La serie de Fourier exponencial compleja tiene Dn: <img src="penultimo_eq11462128157880710935.png" alt="$\left.\frac{-1}{\pi (1/2+j2n)}e^{-(1/2+j2n)t}\right |_{t=0}^{\pi}$" style="width:144px;height:28px;"> Para un resultado mas exacto : <img src="penultimo_eq08029797175683308747.png" alt="$\frac{-1}{\pi (1/2+j2n)}(e^{-\frac{\pi}{2}}-1)$" style="width:114px;height:21px;"></p><pre class="codeinput"><span class="keyword">for</span> n=2:1:5
   magnitud_exacta(n)=abs((-exp(-pi/2)+1)/(pi*(0.5+2j*(n-1))));
<span class="keyword">end</span>
magnitud_exacta(1)=abs((-exp(-pi/2)+1)/(pi*(0.5)));

<span class="keyword">for</span> n=2:1:5
   angulo_exacto(n)=angle((-exp(-pi/2)+1)/(pi*(0.5+2j*(n-1))));
<span class="keyword">end</span>
angulo_exacto(1)=angle((-exp(-pi/2)+1)/(pi*(0.5)));

<span class="comment">%%TABLAS DE COMPARACION</span>

MyA = table(Magnitud',Angulo',mag',ang',magnitud_exacta',angulo_exacto');
MyA(1:5,:);
MyA.Properties.RowNames = {<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>,<span class="string">'D4'</span>};
MyA.Properties.VariableNames{<span class="string">'Var1'</span>} = <span class="string">'Magnitud_ATC'</span>;
MyA.Properties.VariableNames{<span class="string">'Var2'</span>} = <span class="string">'Angulo_ATC'</span>;
MyA.Properties.VariableNames{<span class="string">'Var3'</span>} = <span class="string">'Magnitud_Lathi'</span>;
MyA.Properties.VariableNames{<span class="string">'Var4'</span>} = <span class="string">'Angulo_Lathi'</span>;
MyA.Properties.VariableNames{<span class="string">'Var5'</span>} = <span class="string">'Magnitud_Exacta'</span>;
MyA.Properties.VariableNames{<span class="string">'Var6'</span>} = <span class="string">'Angulo_Exacto'</span>

TRAPE=Magnitud.*exp(1j*Angulo);
LATHI=mag.*exp(1j.*ang);
EXACTO=magnitud_exacta.*exp(1j*angulo_exacto);

Dns= table(LATHI',TRAPE',EXACTO');
Dns.Properties.RowNames = {<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>,<span class="string">'D4'</span>};
Dns.Properties.VariableNames{<span class="string">'Var1'</span>} = <span class="string">'Dn_segunLathi'</span>;
Dns.Properties.VariableNames{<span class="string">'Var2'</span>} = <span class="string">'Dn_SegunAlgTrapComp'</span>;
Dns.Properties.VariableNames{<span class="string">'Var3'</span>} = <span class="string">'Dn_Exacto'</span>

<span class="comment">% Comparaci&oacute;n</span>
LATHI_EXACTO=abs(EXACTO-LATHI);
TRAPE_EXACTO=abs(EXAC-TRAPE);

Comp= table(LATHI_EXACTO',TRAPE_EXACTO');
Comp.Properties.RowNames = {<span class="string">'D0'</span>,<span class="string">'D1'</span>,<span class="string">'D2'</span>,<span class="string">'D3'</span>,<span class="string">'D4'</span>};
Comp.Properties.VariableNames{<span class="string">'Var1'</span>} = <span class="string">'ERROR_Lathi'</span>;
Comp.Properties.VariableNames{<span class="string">'Var2'</span>} = <span class="string">'ERROR_del_Algoritmo'</span>
</pre><pre class="codeinput">El <span class="string">metodo</span> <span class="string">utilizado</span> <span class="string">en</span> <span class="string">el</span> <span class="string">Lathi</span> <span class="string">del</span> <span class="string">DFT(discrete Fourier transform)</span> <span class="string">es</span>
mas <span class="string">acercado</span> <span class="string">a</span> <span class="string">los</span> <span class="string">valores</span> <span class="string">exactos</span> <span class="string">que</span> <span class="string">el</span> <span class="string">algoritmo</span> <span class="string">del</span> <span class="string">trapecio</span>
compuesto
</pre>
<!---->
    <h1 id ="gg">Referencias</h1> 
    
    <a href="https://la.mathworks.com/help/">MatLab</a>
    <a href="https://www.w3schools.com/">HTML & CSS</a>
    <a href="https://oeis.org/wiki/List_of_LaTeX_mathematical_symbols">LaTeX</a>
    <a href="https://www.academia.edu/9017852/Linear-Systems-and-Signals-2nd-Edition-B_P.-Lathi">Lathi</a>
</body></html>